# Implementation Plan: Context Architecture Optimization (Skills-Based)

> Generated by `/PACT:plan-mode` on 2026-01-15
> Status: SUPERSEDED
> **Superseded by**: `context-architecture-protocols-plan.md` (protocol partitioning approach preferred over skills)

<!-- Status Lifecycle:
     PENDING APPROVAL ‚Üí APPROVED ‚Üí IN_PROGRESS ‚Üí IMPLEMENTED
                    ‚Üò SUPERSEDED (if replaced by newer plan)
                    ‚Üò BLOCKED (if unresolved conflicts)

     Transition Ownership:
     - PENDING APPROVAL ‚Üí APPROVED: User (explicit approval)
     - APPROVED ‚Üí IN_PROGRESS: Orchestrator (when /PACT:orchestrate starts)
     - IN_PROGRESS ‚Üí IMPLEMENTED: Orchestrator (after successful completion)
     - Any ‚Üí SUPERSEDED: plan-mode (when creating replacement plan)
     - Any ‚Üí BLOCKED: plan-mode (when unresolved blocking conflicts)
-->

## Summary

Implement skills-based lazy loading for the PACT framework by compressing CLAUDE.md from 306 lines to ~85 lines and creating three new protocol skills (`pact-delegation`, `pact-orchestration-modes`, `pact-variety-assessment`) to replace monolithic pact-protocols.md loading.

**Framework-wide impact**: This refactoring benefits all 8 PACT commands, not just `/PACT:orchestrate`. The heaviest commands (`orchestrate`, `plan-mode`) see 67-71% reductions, while all commands benefit from 72% smaller CLAUDE.md at session start. Expected savings: ~73% reduction in typical orchestration context load (~45K ‚Üí ~12K tokens).

**Supersedes**: PR #68 draft plan (protocol-file approach replaced by skills-based approach per Anthropic research)

---

## Specialist Perspectives

### üìã Preparation Phase
**Effort**: Low-Medium

#### Research Completed
- [x] Anthropic context engineering guidance reviewed
- [x] CLAUDE.md best practices documented (< 60 lines ideal, < 300 max)
- [x] Skills lazy-loading behavior understood (metadata at startup, full on activation)
- [x] Current context load measured (CLAUDE.md ~4K, pact-protocols.md ~10K tokens)

#### Remaining Gaps (Acceptable Risk)
- [ ] Skill auto-activation keyword patterns ‚Äî validate during implementation
- [ ] Cross-skill dependency handling ‚Äî test during Phase 5

#### Questions Resolved
- **Content classification**: Architect provided detailed partitioning (see Architecture Phase)
- **Algedonic location**: Keep separate algedonic.md file (already concise, safety-critical)
- **VSM distribution**: Keep vsm-glossary.md as central reference; skills link to it

---

### üèóÔ∏è Architecture Phase
**Effort**: Medium

#### Components Affected
| Component | Change Type | Impact |
|-----------|-------------|--------|
| `CLAUDE.md` | Compress | 306 ‚Üí ~85 lines |
| `pact-protocols.md` | Reduce | 1,086 ‚Üí ~300 lines (keep S1/S2/S3* only) |
| `commands/PACT/orchestrate.md` | Modify | Remove @protocol refs, add skill invocations |
| `commands/PACT/plan-mode.md` | Modify | Remove @protocol refs, add skill invocations |
| `commands/PACT/imPACT.md` | Modify | Remove @protocol refs |
| `skills/pact-delegation/` | New | ~120 lines |
| `skills/pact-orchestration-modes/` | New | ~180 lines |
| `skills/pact-variety-assessment/` | New | ~150 lines |

#### Design Approach

**Three-Skill Architecture**:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                       CLAUDE.md (~85 lines)                 ‚îÇ
‚îÇ  Always loaded: Mission, S5 Policy, Specialist list,       ‚îÇ
‚îÇ                 Command list, Skill activation guide        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ References by name (lazy-load on demand)
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      Protocol Skills                        ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  pact-delegation (~120 lines)                               ‚îÇ
‚îÇ  ‚îî‚îÄ Tool checkpoint, app code definition, recovery          ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  pact-orchestration-modes (~180 lines)                      ‚îÇ
‚îÇ  ‚îî‚îÄ S3/S4 modes, checkpoints, tensions, temporal horizons   ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  pact-variety-assessment (~150 lines)                       ‚îÇ
‚îÇ  ‚îî‚îÄ Variety scoring, workflow selection, strategies         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îÇ Auto-activated by keywords in commands
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Commands (loaded on invocation)                            ‚îÇ
‚îÇ  ‚îî‚îÄ No @pact-protocols refs; reference skills by name       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Key Decisions
| Decision | Options | Recommendation | Rationale |
|----------|---------|----------------|-----------|
| Skill count | 3 focused vs 4-5 fine-grained | 3 skills | Clear boundaries, targeted loading, simpler maintenance |
| CLAUDE.md size | 60-80 vs 80-100 lines | ~85 lines | Balance between compression and safety-critical content |
| Algedonic handling | In CLAUDE.md vs skill vs separate | Keep algedonic.md | Already concise, safety-critical, well-isolated |
| Protocol residue | Delete vs lean file | Lean (~300 lines) | Keep S1/S2/S3* for specialized cases |

#### Interface Contracts

**Skill Discovery Mechanism**:

Skills in Claude Code are auto-discovered based on their `description` frontmatter. Claude reads all skill descriptions at session start and activates the relevant skill when conversation context matches.

**Command Text Pattern** (how commands trigger skills):
```markdown
# Current (loads entire 1,086-line file):
See @~/.claude/protocols/pact-protocols.md for S4 Checkpoint Protocol.

# New (triggers skill discovery via keywords):
When performing S4 checkpoints, apply the S4 Checkpoint Protocol.
```

The new text contains "S4 checkpoint" which matches `pact-orchestration-modes` description, causing Claude to load only that ~180-line skill.

**Trigger Keywords by Skill** (embedded in description):
| Skill | Keywords in Description |
|-------|-------------------------|
| `pact-delegation` | delegate, Edit, Write, application code, tool checkpoint, recovery |
| `pact-orchestration-modes` | S3, S4, checkpoint, tension, phase transition, temporal horizon |
| `pact-variety-assessment` | variety, complexity, comPACT, orchestrate, plan-mode, workflow selection |

**Best Practice**: Commands should use natural language containing trigger keywords rather than explicit "invoke skill X" instructions. This allows Claude's discovery mechanism to work naturally.

---

### üíª Code Phase
**Effort**: Medium

> **Note**: This is AI tooling (.claude/ files), not application code. Per delegation rules, the orchestrator may implement these changes directly. No specialist delegation required.

#### Files to Create
| File | Purpose | Est. Lines |
|------|---------|------------|
| `.claude/skills/pact-delegation/SKILL.md` | Delegation enforcement, tool checkpoint, recovery | ~120 |
| `.claude/skills/pact-orchestration-modes/SKILL.md` | S3/S4 modes, checkpoints, temporal horizons | ~180 |
| `.claude/skills/pact-variety-assessment/SKILL.md` | Variety scoring, workflow selection | ~150 |

#### Skill Specifications (Frontmatter & Discovery)

Skills are discovered through their `description` field, not @-references. Claude reads skill descriptions at session start and auto-activates based on context matching.

**pact-delegation**:
```yaml
---
name: pact-delegation
description: |
  Delegation enforcement rules and tool checkpoint protocol for PACT orchestrators.
  Use when: about to edit application code, using Edit/Write tools, determining
  what constitutes application code, or recovering from delegation violations.
  Triggers on: delegate, Edit, Write, application code, tool checkpoint, recovery,
  specialist agents, code ownership.
---
```

**pact-orchestration-modes**:
```yaml
---
name: pact-orchestration-modes
description: |
  S3/S4 operational modes, checkpoints, and tension resolution for PACT orchestration.
  Use when: transitioning between phases, performing S4 checkpoints, detecting S3/S4
  tension, assessing temporal horizons, or managing mode transitions.
  Triggers on: S3, S4, checkpoint, tension, phase transition, temporal horizon,
  inside-now, outside-future, mode, operational control, strategic intelligence.
---
```

**pact-variety-assessment**:
```yaml
---
name: pact-variety-assessment
description: |
  Variety scoring rubric and workflow selection for PACT task complexity assessment.
  Use when: starting a new task, selecting between comPACT/orchestrate/plan-mode,
  assessing task complexity, or applying variety attenuators/amplifiers.
  Triggers on: variety, complexity, comPACT, orchestrate, plan-mode, workflow
  selection, novelty, scope, uncertainty, risk, attenuate, amplify.
---
```

#### How Skill Discovery Replaces @-References

**Current pattern** (loads entire file):
```markdown
See @~/.claude/protocols/pact-protocols.md for S4 Checkpoint Protocol.
```

**New pattern** (triggers skill discovery):
```markdown
When performing S4 checkpoints, apply the S4 Checkpoint Protocol.
```

Claude's skill discovery matches "S4 checkpoint" against `pact-orchestration-modes` description and loads only that skill (~180 lines vs ~1,086 lines).

**Key insight**: We remove explicit @-references and use natural language that contains the trigger keywords defined in skill descriptions. Claude handles the discovery automatically.

#### Files to Modify
| File | Changes |
|------|---------|
| `CLAUDE.md` | Compress from 306 ‚Üí ~85 lines per structure below |
| `.claude/protocols/pact-protocols.md` | Reduce from 1,086 ‚Üí ~300 lines (keep S1/S2/S3* only) |
| `.claude/commands/PACT/orchestrate.md` | Remove @pact-protocols refs, add skill references |
| `.claude/commands/PACT/plan-mode.md` | Remove @pact-protocols ref, add skill references |
| `.claude/commands/PACT/imPACT.md` | Remove @algedonic ref (keep algedonic.md reference) |
| `pact-plugin/skills/` | Mirror new skills for plugin distribution |

#### CLAUDE.md Proposed Structure (~85 lines)

```markdown
# MISSION (7 lines)
Mission statement, motto

## S5 POLICY (12 lines)
Non-negotiables table (4 rows), policy checkpoint summary
‚Üí "Invoke pact-delegation skill for enforcement details"

## INSTRUCTIONS (6 lines)
Core directives

## GUIDELINES (12 lines)
Context management, git workflow, communication

## PACT PHASES (8 lines)
Phase names + one-liner principles
‚Üí "Invoke domain skills for detailed phase guidance"

## SPECIALIST AGENTS (10 lines)
Agent list with emoji identifiers

## ORCHESTRATION COMMANDS (12 lines)
Command list with one-line descriptions
‚Üí "Invoke pact-variety-assessment skill to select workflow"

## DOCUMENTATION LOCATIONS (8 lines)
Phase ‚Üí Output Location table

## SKILL ACTIVATION GUIDE (10 lines)
When to invoke each protocol skill
```

#### Implementation Sequence
1. `feat(skills): create pact-delegation skill` ‚Äî Extract delegation content
2. `feat(skills): create pact-orchestration-modes skill` ‚Äî Extract S3/S4 content
3. `feat(skills): create pact-variety-assessment skill` ‚Äî Extract variety content
4. `refactor(claude): compress CLAUDE.md to ~85 lines` ‚Äî Restructure with skill refs
5. `refactor(protocols): reduce pact-protocols.md to ~300 lines` ‚Äî Keep S1/S2/S3* only
6. `refactor(commands): update orchestrate.md skill references` ‚Äî Remove @protocol loads
7. `refactor(commands): update plan-mode.md skill references` ‚Äî Remove @protocol loads
8. `refactor(commands): update imPACT.md references` ‚Äî Minor cleanup
9. `chore(plugin): sync new skills to pact-plugin/` ‚Äî Mirror for distribution

---

### üß™ Test Phase
**Effort**: Medium (4-6 hours manual validation)

#### Test Scenarios
| Scenario | Type | Priority |
|----------|------|----------|
| `/PACT:orchestrate` invokes correct skills | Integration | P0 |
| `/PACT:comPACT` loads delegation skill | Integration | P0 |
| Delegation enforcement on app code edit | Functional | P0 |
| Algedonic HALT signal bypasses to user | Functional | P0 |
| Tool Checkpoint Protocol fires before Edit/Write | Functional | P0 |
| `/PACT:plan-mode` activates variety skill | Integration | P1 |
| `/PACT:imPACT` loads triage guidance | Integration | P1 |
| S3/S4 mode detection in responses | Functional | P1 |
| `/PACT:rePACT` nested skill loading | Edge case | P2 |
| Multiple skills loaded in single command | Edge case | P2 |

#### Coverage Targets
- Critical path (P0): 100% ‚Äî Must pass for merge
- Core workflows (P1): 100% ‚Äî Should pass for merge
- Edge cases (P2): Best effort ‚Äî May defer

#### Validation Approach

**Phase 1: Smoke Testing (1-2 hours)**
- Execute each PACT command once
- Verify skill-specific guidance appears
- Check delegation enforcement

**Phase 2: Comprehensive Validation (3-4 hours)**
- All P0/P1 scenarios
- Before/after comparison for lost guidance
- Edge case testing

#### Acceptance Criteria
- [ ] All new skill files exist and are syntactically valid
- [ ] Compressed CLAUDE.md contains delegation enforcement rules
- [ ] Compressed CLAUDE.md contains SACROSANCT policy
- [ ] `/PACT:orchestrate` executes without errors
- [ ] `/PACT:comPACT` executes without errors
- [ ] Tool Checkpoint Protocol triggers on application code
- [ ] Algedonic HALT scenario escalates to user
- [ ] No command produces "skill not found" errors

---

## Synthesized Implementation Roadmap

### Phase Sequence

```
Phase 1: Create Skills (Low Risk)
‚îú‚îÄ‚îÄ pact-delegation/SKILL.md
‚îú‚îÄ‚îÄ pact-orchestration-modes/SKILL.md
‚îî‚îÄ‚îÄ pact-variety-assessment/SKILL.md
         ‚îÇ
         ‚ñº Smoke test skill activation
         ‚îÇ
Phase 2: Compress CLAUDE.md (Medium Risk)
‚îú‚îÄ‚îÄ Restructure to ~85 lines
‚îî‚îÄ‚îÄ Add skill activation guide
         ‚îÇ
         ‚ñº Validate delegation/algedonic preserved
         ‚îÇ
Phase 3: Update Commands (Medium Risk)
‚îú‚îÄ‚îÄ orchestrate.md
‚îú‚îÄ‚îÄ plan-mode.md
‚îî‚îÄ‚îÄ imPACT.md
         ‚îÇ
         ‚ñº Full command validation
         ‚îÇ
Phase 4: Lean Protocol (Low Risk)
‚îî‚îÄ‚îÄ Reduce pact-protocols.md to ~300 lines
         ‚îÇ
         ‚ñº Comprehensive validation
         ‚îÇ
Phase 5: Plugin Sync (Low Risk)
‚îî‚îÄ‚îÄ Mirror to pact-plugin/
         ‚îÇ
         ‚ñº Final PR review
```

### Commit Sequence (Proposed)

> **Note**: This sequence represents the intended final git history order, **not** the execution order. Phases 1-3 may have parallel work streams.

1. `feat(skills): create pact-delegation skill with tool checkpoint protocol` ‚Äî Delegation enforcement content
2. `feat(skills): create pact-orchestration-modes skill with S3/S4 guidance` ‚Äî Operational modes content
3. `feat(skills): create pact-variety-assessment skill with scoring rubric` ‚Äî Variety management content
4. `refactor(claude): compress CLAUDE.md from 306 to ~85 lines` ‚Äî Core restructuring
5. `refactor(protocols): reduce pact-protocols.md to S1/S2/S3* sections (~300 lines)` ‚Äî Protocol cleanup
6. `refactor(commands): update PACT commands to reference skills instead of protocols` ‚Äî Command updates
7. `chore(plugin): sync new skills to pact-plugin/ directory` ‚Äî Distribution sync
8. `docs: update context architecture documentation` ‚Äî Document new structure

---

## Cross-Cutting Concerns

| Concern | Status | Notes |
|---------|--------|-------|
| Security | ‚úÖ Ready | Delegation enforcement and algedonic signals preserved in accessible locations |
| Performance | ‚úÖ Focus | ~73% token reduction: ~45K ‚Üí ~12K per orchestration |
| Accessibility | N/A | Not frontend work |
| Observability | ‚ö†Ô∏è Monitor | Track skill activation patterns during validation |

---

## Open Questions

### Require User Decision

None ‚Äî all key decisions resolved during synthesis.

### Require Further Research

- [ ] **Skill auto-activation reliability**: Validate trigger keywords work as expected during Phase 1
- [ ] **Cross-skill dependencies**: Test if `pact-variety-assessment` correctly informs orchestration mode selection during Phase 3

---

## Risk Assessment

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Skill auto-activation fails | Medium | High | Careful keyword selection; fallback instructions in CLAUDE.md |
| Critical guidance lost in compression | Low | High | Before/after comparison; keep delegation/algedonic explicit |
| Commands break after @ref removal | Medium | Medium | Staged rollout; test each command after update |
| Plugin sync drift | Low | Medium | Mirror skills in same PR; verify with diff |
| Content duplication across skills | Low | Low | Clear ownership; cross-references not duplication |

---

## Scope Assessment

- **Overall Complexity**: Medium (Variety Score: 9)
- **Estimated Files**: 3 new skill files, 6 modified files
- **Specialists Required**: None (AI tooling ‚Äî orchestrator may implement directly)
- **External Dependencies**: No ‚Äî internal refactoring only

---

## PACT Framework Coverage

This plan addresses context management across the **entire PACT framework**, not just `/PACT:orchestrate`.

### Complete Command Inventory

| Command | Lines | @-Protocol References | Plan Action |
|---------|-------|----------------------|-------------|
| **orchestrate.md** | 480 | 6√ó pact-protocols + 1√ó algedonic | ‚úÖ Remove @refs, add skill invocations |
| **plan-mode.md** | 441 | 1√ó pact-protocols | ‚úÖ Remove @refs, add skill invocations |
| **imPACT.md** | ~100 | 2√ó algedonic | ‚úÖ Simplify algedonic refs |
| **rePACT.md** | 250 | None (self-contained) | ‚ö™ No changes needed |
| **comPACT.md** | 190 | None (self-contained) | ‚ö™ No changes needed |
| **peer-review.md** | 27 | None (self-contained) | ‚ö™ No changes needed |
| **wrap-up.md** | 35 | None (refs skill) | ‚ö™ No changes needed |
| **log-changes.md** | 27 | None (self-contained) | ‚ö™ No changes needed |

**Key insight**: Only three commands (`orchestrate`, `plan-mode`, `imPACT`) have @-protocol references that cause heavy context loading. The remaining five commands are already lightweight and self-contained.

### Universal Benefit: CLAUDE.md Compression

The CLAUDE.md compression (306 ‚Üí ~85 lines) benefits **every command and every session**:

| Entry Point | Current CLAUDE.md | After Compression | Savings |
|-------------|-------------------|-------------------|---------|
| All commands | 306 lines (~4K tokens) | ~85 lines (~1K tokens) | **72%** |

### Per-Command Context Load (Before/After)

| Command | Current Total | After Plan | Reduction |
|---------|---------------|------------|-----------|
| **orchestrate** | ~2,100 lines | ~700 lines | **67%** |
| **plan-mode** | ~1,830 lines | ~530 lines | **71%** |
| **imPACT** | ~640 lines | ~320 lines | **50%** |
| **comPACT** | ~496 lines | ~275 lines | **45%** |
| **rePACT** | ~556 lines | ~335 lines | **40%** |
| **peer-review** | ~333 lines | ~112 lines | **66%** |
| **wrap-up** | ~341 lines | ~120 lines | **65%** |
| **log-changes** | ~333 lines | ~112 lines | **66%** |

*Note: Totals include CLAUDE.md + command file + any @-referenced protocol files.*

### Why Lightweight Commands Still Benefit

Commands like `comPACT`, `rePACT`, and `peer-review` have no @-protocol references, but they still load CLAUDE.md at session start. The 72% reduction in CLAUDE.md size means:
- More context budget available for actual task work
- Reduced risk of hitting context limits during extended sessions
- Faster session initialization

---

## Token Savings Analysis

| Scenario | Current Load | After Refactor | Savings |
|----------|--------------|----------------|---------|
| Session start (CLAUDE.md) | ~4K | ~1K | 75% |
| /PACT:orchestrate invocation | +15K (protocols) | +2K (targeted skills) | 87% |
| /PACT:comPACT invocation | ~2K (no protocols) | ~1K | 50% |
| /PACT:plan-mode invocation | +10K (protocols) | +2K (targeted skills) | 80% |
| Typical full orchestration | ~45K | ~12K | **73%** |

---

## Related Context

- **Issue**: #64 - Context Architecture Review
- **Supersedes**: PR #68 draft plan (protocol-file approach)
- **Research Basis**: Anthropic Context Engineering Guide, Skill Authoring Best Practices

---

## Next Steps

After approval:
```
/PACT:orchestrate implement skills-based context architecture optimization per approved plan
```

The orchestrator will reference this plan during execution. Since this is AI tooling (not application code), the orchestrator may implement changes directly without delegating to specialist coders.
